<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Relatório Keras | Estudo e Aplicação de Técnicas de Machine Learning</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Todos os relatórios e afins sobre machine learning, deep learning e Visão computacional estarão aqui.">
    
    <link rel="preload" href="/machineLearning/assets/css/0.styles.f80be0c7.css" as="style"><link rel="preload" href="/machineLearning/assets/js/app.85d7bd56.js" as="script"><link rel="preload" href="/machineLearning/assets/js/2.4f8302c5.js" as="script"><link rel="preload" href="/machineLearning/assets/js/13.fcdeb0ea.js" as="script"><link rel="prefetch" href="/machineLearning/assets/js/10.29b60263.js"><link rel="prefetch" href="/machineLearning/assets/js/11.c63c2c0c.js"><link rel="prefetch" href="/machineLearning/assets/js/12.78249c11.js"><link rel="prefetch" href="/machineLearning/assets/js/14.ced299f6.js"><link rel="prefetch" href="/machineLearning/assets/js/15.df6f2744.js"><link rel="prefetch" href="/machineLearning/assets/js/16.58f755ed.js"><link rel="prefetch" href="/machineLearning/assets/js/17.ce969e99.js"><link rel="prefetch" href="/machineLearning/assets/js/18.47c54fbb.js"><link rel="prefetch" href="/machineLearning/assets/js/19.73db5433.js"><link rel="prefetch" href="/machineLearning/assets/js/20.4168cf0b.js"><link rel="prefetch" href="/machineLearning/assets/js/21.320089d5.js"><link rel="prefetch" href="/machineLearning/assets/js/22.1740eda5.js"><link rel="prefetch" href="/machineLearning/assets/js/23.269b9116.js"><link rel="prefetch" href="/machineLearning/assets/js/24.850bbadc.js"><link rel="prefetch" href="/machineLearning/assets/js/25.40c583f5.js"><link rel="prefetch" href="/machineLearning/assets/js/26.d2dc0497.js"><link rel="prefetch" href="/machineLearning/assets/js/27.c3a0af4f.js"><link rel="prefetch" href="/machineLearning/assets/js/28.a01a0b69.js"><link rel="prefetch" href="/machineLearning/assets/js/29.c2a025ff.js"><link rel="prefetch" href="/machineLearning/assets/js/3.7ee3d1e9.js"><link rel="prefetch" href="/machineLearning/assets/js/30.82d06992.js"><link rel="prefetch" href="/machineLearning/assets/js/31.855a9550.js"><link rel="prefetch" href="/machineLearning/assets/js/4.c3fb2158.js"><link rel="prefetch" href="/machineLearning/assets/js/5.02305c60.js"><link rel="prefetch" href="/machineLearning/assets/js/6.4a48f0f1.js"><link rel="prefetch" href="/machineLearning/assets/js/7.7322ff41.js"><link rel="prefetch" href="/machineLearning/assets/js/8.198f804d.js"><link rel="prefetch" href="/machineLearning/assets/js/9.0acdc198.js">
    <link rel="stylesheet" href="/machineLearning/assets/css/0.styles.f80be0c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/machineLearning/" class="home-link router-link-active"><!----> <span class="site-name">Estudo e Aplicação de Técnicas de Machine Learning</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/machineLearning/artigos/sobre.html" class="nav-link">
  Artigos
</a></div><div class="nav-item"><a href="/machineLearning/glossario/funcoes/" class="nav-link">
  Glossário
</a></div><div class="nav-item"><a href="/machineLearning/relatorios/relatorio.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Relatorios
</a></div><div class="nav-item"><a href="/machineLearning/veiculos/intro.html" class="nav-link">
  Veículos Autônomos
</a></div><div class="nav-item"><a href="/machineLearning/tcc/index.html" class="nav-link">
  TCC
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/machineLearning/artigos/sobre.html" class="nav-link">
  Artigos
</a></div><div class="nav-item"><a href="/machineLearning/glossario/funcoes/" class="nav-link">
  Glossário
</a></div><div class="nav-item"><a href="/machineLearning/relatorios/relatorio.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Relatorios
</a></div><div class="nav-item"><a href="/machineLearning/veiculos/intro.html" class="nav-link">
  Veículos Autônomos
</a></div><div class="nav-item"><a href="/machineLearning/tcc/index.html" class="nav-link">
  TCC
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Machine Learning</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Deep Learning</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/machineLearning/relatorios/relatorio.html" aria-current="page" class="active sidebar-link">Relatório Keras</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#introducao" class="sidebar-link">Introdução</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#datasets" class="sidebar-link">Datasets</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#sequential" class="sidebar-link">Sequential</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#compile" class="sidebar-link">Compile</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#training-fit" class="sidebar-link">Training (fit)</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#predict" class="sidebar-link">Predict</a></li><li class="sidebar-sub-header"><a href="/machineLearning/relatorios/relatorio.html#referencias" class="sidebar-link">Referências</a></li></ul></li><li><a href="/machineLearning/relatorios/relatorio_tfjs.html" class="sidebar-link">Relatório TensorflowJS</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Veículos autônomos</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="introducao"><a href="#introducao" class="header-anchor">#</a> Introdução</h2> <p>Esse relatório tem como objetivo fazer um overview explicando os processos utilizados do inicío até o fim de um treinamento utilizando o Keras. Futuramente será feito um relatório entrando em detalhes mais profundos como parâmetros, algorítmos de perda/ otimização e etc.</p> <p>Keras é uma API de redes neurais de alto nível, escrita em Python e capaz de executar sobre TensorFlow, CNTK ou Theano.</p> <h2 id="datasets"><a href="#datasets" class="header-anchor">#</a> Datasets</h2> <p>Antes de iniciar, é preciso escolher um dataset. O próprio Keras já disponibiliza alguns:</p> <ul><li><p><strong>boston_housing module</strong>: Conjunto de dados de regressão do preço da habitação em Boston.</p></li> <li><p><strong>cifar10 module</strong>: Conjunto de dados de classificação de imagens pequenas CIFAR10 (60000 imagens coloridas de 32 x 32 em 10 classes, com 6000 imagens por classe).</p></li> <li><p><strong>cifar100 module</strong>: Conjunto de dados de classificação de imagens pequenas CIFAR100 (assim como o CIFAR-10, exceto que possui 100 classes contendo 600 imagens cada).</p></li> <li><p><strong>fashion_mnist module</strong>: Dataset Fashion-MNIST (conjunto de dados das imagens dos itens da loja <strong>Zalando</strong> - consistindo em um conjunto de treinamento de 60.000 exemplos e um conjunto de testes de 10.000 exemplos. Cada exemplo é uma imagem em escala de cinza de 28 x 28, associada a um rótulo de 10 classes).</p></li> <li><p><strong>imdb module</strong>: Conjunto de dados de classificação de sentimentos do IMDB.</p></li> <li><p><strong>mnist module</strong>: Conjunto de dados de dígitos manuscritos MNIST.</p></li> <li><p><strong>reuters module</strong>: Conjunto de dados de classificação de tópicos da <strong>Reuters</strong>.</p></li></ul> <p>Para o curso foi utilizado o <strong>fashion_mnist module</strong>.</p> <h2 id="sequential"><a href="#sequential" class="header-anchor">#</a> Sequential</h2> <p>O modelo Sequencial (<strong>keras.Sequential</strong>) é uma pilha linear de camadas.</p> <p>É possível criar um modelo seqüencial passando uma lista de instâncias de camada para o construtor:</p> <div class="language- extra-class"><pre><code>modelo = keras.Sequential([
    # Camada de entrada
    keras.layers.Flatten(input_shape = (28,28)), # As imagens, de 28 por 28 pixels (input_shape = tamanho das entradas).
    
    # Processamento (camada do tipo dense,
    keras.layers.Dense(256, activation = tf.nn.relu), # =&gt; Não há um número exato, ele deve ser testado e ajustado.

    # 'Adormecer' alguns itens, normalizando o modelo
    keras.layers.Dropout(0.2),
    
    # Saida
    keras.layers.Dense(10, activation = tf.nn.softmax), # =&gt; Aqui eu coloco 10 porque eu tenho 10 tipos de categorias.
])
</code></pre></div><p>Os modelos em Keras são definidos como uma sequência de camadas.</p> <h3 id="camada-flatten"><a href="#camada-flatten" class="header-anchor">#</a> Camada Flatten</h3> <p>O <strong>keras.Flatten</strong> basicamente <em>nivela a entrada</em>. Achatar um tensor significa remover todas as dimensões, exceto uma. É exatamente isso que a camada <strong>Flatten</strong> faz.</p> <p><img src="https://i.stack.imgur.com/IBt6j.jpg" alt=""></p> <h3 id="camada-dense"><a href="#camada-dense" class="header-anchor">#</a> Camada Dense</h3> <p>Conforme a documentação, <em>Apenas a sua camada NN comum, densamente conectada</em> (NN = neural network). Ou seja, a cadada <em>core</em>. É a implementação da equação:</p> <div class="language- extra-class"><pre><code>output = activation(dot(input, kernel) + bias)
</code></pre></div><p>Isso significa que estamos pegando o produto escalar entre nosso tensor de entrada e qualquer que seja a matriz de núcleo de peso que esteja presente em nossa camada densa. Em seguida, adicionamos um vetor de viés  e realizamos uma ativação por elemento dos valores de saída (<strong>relu no nosso caso</strong>).</p> <h3 id="dropout"><a href="#dropout" class="header-anchor">#</a> Dropout</h3> <p>Aplica o Dropout à entrada.</p> <p>O <strong>Dropout</strong> (abandono) consiste em definir aleatoriamente uma taxa de fração das unidades de entrada como 0 a cada atualização durante o tempo de treinamento, o que ajuda a evitar o ajuste excessivo (overfitting).</p> <p><img src="https://hackernoon.com/hn-images/1*L392ucqge-zTsOJYieRN7A.png" alt=""></p> <p><strong>Overfitting:</strong> Quando um modelo é treinado com muitos dados, ele começa a aprender com o ruído e as entradas de dados imprecisas em nosso conjunto de dados. Em seguida, o modelo não categoriza os dados corretamente, devido a muitos detalhes e ruídos.</p> <h2 id="compile"><a href="#compile" class="header-anchor">#</a> Compile</h2> <p>Antes de treinar um modelo, é preciso configurar o processo de aprendizado, que é feito pelo método de compilação. Ele recebe três argumentos:</p> <ul><li><p><strong>Um otimizador (optimizer)</strong>. Pode ser o identificador de sequência de um otimizador existente (como rmsprop ou adagrad) ou uma instância da classe Optimizer.</p></li> <li><p><strong>Uma função de perda (loss)</strong>. Esse é o objetivo que o modelo tentará minimizar. Pode ser o identificador de sequência de uma função de perda existente (como categorical_crossentropy ou mse) ou pode ser uma função objetiva.</p></li> <li><p><strong>Uma lista de métricas (metrics)</strong>. Para qualquer problema de classificação, defina isso como métricas = ['precisão']. Uma métrica pode ser o identificador de sequência de uma métrica existente ou uma função de métrica personalizada.</p> <div class="language- extra-class"><pre><code>  modelo.compile(
      # Otimizador
      optimizer=adam, 
      
      # Função de perda
      loss='sparse_categorical_crossentropy',
      
      # métricas
      metrics=['accuracy']
  )
</code></pre></div></li></ul> <h2 id="training-fit"><a href="#training-fit" class="header-anchor">#</a> Training (fit)</h2> <p>Após configurar e compilar o modelo, fazemos o treinamento dele com o <strong>.fit</strong>. Conforme a documentação: <em>Treina o modelo para um número fixo de épocas (iterações em um conjunto de dados).</em></p> <p>O retorno é um objeto <em>History</em>. Seu atributo <strong>History.history</strong> é um registro de valores de perda de treinamento e valores de métricas em épocas sucessivas, bem como valores de perda de validação e valores de métricas de validação.</p> <div class="language- extra-class"><pre><code>historico = modelo.fit(imagens_treino, identificacoes_treino, epochs=5, validation_split=0.2)
</code></pre></div><p><img src="/machineLearning/assets/img/fit.2c2f2983.png" alt=""></p> <h2 id="predict"><a href="#predict" class="header-anchor">#</a> Predict</h2> <p>Por fim, após toda a parte custosa do Deep Learning ter sido finalizada, podemos fazer as predições usando nosso modelo com o <strong>.predict</strong> . Segundo a documentação, o predict:</p> <div class="language- extra-class"><pre><code>Gera previsões de saída para as amostras de entrada.
</code></pre></div><p><img src="/machineLearning/assets/img/predict.bf8734d4.png" alt=""></p> <h2 id="referencias"><a href="#referencias" class="header-anchor">#</a> Referências</h2> <p>[1] https://keras.io/</p> <p>[2] https://www.dobitaobyte.com.br/rede-neural-com-keras-mais-anotacoes/</p> <p>[3] https://stackoverflow.com/questions/43237124/what-is-the-role-of-flatten-in-keras</p> <p>[4] https://medium.com/@hunterheidenreich/understanding-keras-dense-layers-2abadff9b990</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/machineLearning/relatorios/relatorioMl.html" class="prev">
        Relatório MultinomialNB
      </a></span> <span class="next"><a href="/machineLearning/relatorios/relatorio_tfjs.html">
        Relatório TensorflowJS
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/machineLearning/assets/js/app.85d7bd56.js" defer></script><script src="/machineLearning/assets/js/2.4f8302c5.js" defer></script><script src="/machineLearning/assets/js/13.fcdeb0ea.js" defer></script>
  </body>
</html>
